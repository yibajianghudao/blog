---
title: Shell
date: 2025-06-07 09:11:20
tags:
---

# Shell

## 基础

### shebang

shell脚本通常以shebang起始：
#!/bin/bash
shebang是一个文本行,其中`#!`位于解释器路径之前,/bin/bash是Bash的解释器命令路径.

bash将以#符号开头的行视为注释.脚本中只有第一行可以使用shebang来定义解释该脚本所使用的解释器.

### 执行方式

shell脚本有两种执行方式:

1. 把脚本名作为命令行参数:
   ```bash
   bash script.sh
   ```

2. 授予脚本执行权限,将其变为可执行文件:
   ```bash
   chmod 755 script.sh
   ./script.sh
   ```

### 引号的区别

双引号允许shell解释字符串中出现的特殊符号

单引号不会对其做任何解释

```
```





## 打印输出

#### echo

默认情况下，echo在每次调用后会添加一个换行符：

```
echo "Welcome to Bash"
Welcome to Bash
```



### 变量替换

变量名是其所指向值的一个占位符（placeholder）。引用变量值的过程我们称之为变量替换（variable substitution）。

如果变量名是 `variable1`， 那么 `$variable1` 就是对变量值的引用。

变量仅仅在**声明时、赋值时、被删除时**（`unset`）、**被导出时**（`export`），算术运算中使用双括号结构((...))时或在**代表信号时**（signal，查看样例 32-5）才**不需要有 $ 前缀**。赋值可以是使用 =（比如 `var1=27`），可以是在 `read` 语句中，也可以是在循环的头部（`for var2 in 1 2 3`）。

> 在双引号`""`字符串中可以使用变量替换。我们称之为部分引用，有时候也称弱引用。会保留变量的空白符,制表符,分行符
>
> 而使用单引号`''`引用时，变量只会作为字符串显示，变量替换不会发生。我们称之为全引用，有时也称强引用。
>
> ```
> hello="A B  C   D"
> echo $hello   # A B C D
> echo "$hello" # A B  C   D
> echo '$hello'  # $hello
> ```

实际上, `$variable` 这种写法是 `${variable}` 的简化形式。

一个未被赋值或未初始化的变量拥有空值（null value）。*注意：null值不等同于0*。

```
echo "uninitialized_variable = $uninitialized_variable"
# 未初始化的变量是空值(null表示不含有任何值)。
uninitialized_variable=   # 只声明而不初始化，等同于设为空值。
echo "uninitialized_variable = $uninitialized_variable" # 仍旧为空
```



## 常见特殊符号

 ### 注释与命令分隔符

| 字符 | 名称   | 功能说明         | 示例                     |
| ---- | ------ | ---------------- | ------------------------ |
| `#`  | 井号   | 注释行           | `# 这是一条注释`         |
| `;`  | 分号   | 命令分隔符       | `cmd1; cmd2`             |
| `;;` | 双分号 | `case`语句终止符 | `case $var in a) ... ;;` |

### 引号与转义

| 字符 | 名称   | 功能说明                     | 示例                 |
| ---- | ------ | ---------------------------- | -------------------- |
| `'`  | 单引号 | 强引用（禁用所有特殊字符）   | `echo '$PATH'`       |
| `"`  | 双引号 | 弱引用（允许变量和命令扩展） | `echo "Value: $var"` |
| `\`  | 反斜线 | 转义单个字符                 | `echo "Price: \$5"`  |

### 变量与参数扩展

| 字符      | 名称     | 功能说明           | 示例                    |
| --------- | -------- | ------------------ | ----------------------- |
| `$`       | 美元符号 | 变量引用           | `echo $HOME`            |
| `${}`     | 花括号   | 变量名边界         | `echo "${file}_backup"` |
| `$()`     | 命令替换 | 执行命令并替换输出 | `files=$(ls)`           |
| `` ` ` `` | 反引号   | 命令替换（旧式）   | `` files=`ls` ``        |
| `$?`      | 问号     | 上条命令的退出状态 | `if [ $? -eq 0 ]; then` |
| `$$`      | 双美元   | 当前进程的 PID     | `echo "PID: $$"`        |

### 通配符与模式匹配

| 字符  | 名称   | 功能说明                | 示例            |
| ----- | ------ | ----------------------- | --------------- |
| `*`   | 星号   | 匹配任意字符（0或多个） | `ls *.txt`      |
| `?`   | 问号   | 匹配单个字符            | `ls file?.log`  |
| `[]`  | 中括号 | 字符集合匹配            | `ls [abc]*.txt` |
| `[^]` | 脱字符 | 排除字符集合            | `ls [^a-z]*.sh` |

### 命令执行与子shell

| 字符  | 名称     | 功能说明            | 示例                     |
| ----- | -------- | ------------------- | ------------------------ |
| `()`  | 小括号   | 在子shell中执行命令 | `(cd dir; ls)`           |
| `$()` | 命令替换 | 获取命令输出        | `date=$(date +%F)`       |
| `&`   | 与号     | 后台运行命令        | `long_running_command &` |

### 重定向与管道

| 字符 | 名称          | 功能说明           | 示例                   |
| ---- | ------------- | ------------------ | ---------------------- |
| `>`  | 大于号        | 输出重定向（覆盖） | `echo "text" > file`   |
| `>>` | 双大于号      | 输出重定向（追加） | `echo "text" >> file`  |
| `<`  | 小于号        | 输入重定向         | `wc -l < file`         |
| `<<` | Here Document | 内嵌文档重定向     | `cat << EOF ... EOF`   |
| `\|` | 管道          | 连接命令的输入输出 | `ps aux \| grep httpd` |

### 逻辑操作符

| 字符   | 名称   | 功能说明               | 示例                     |
| ------ | ------ | ---------------------- | ------------------------ |
| `&&`   | 逻辑与 | 前命令成功才执行后命令 | `mkdir dir && cd dir`    |
| `\|\|` | 逻辑或 | 前命令失败才执行后命令 | `cmd \|\| echo "Failed"` |
| `!`    | 感叹号 | 逻辑非                 | `if ! [ -f file ]; then` |

### 大括号扩展

| 字符 | 名称   | 功能说明       | 示例                    |
| ---- | ------ | -------------- | ----------------------- |
| `{}` | 花括号 | 生成字符串序列 | `echo {1..5}`           |
|      |        | 命令分组       | `{ cmd1; cmd2; } > log` |

### 其他特殊字符

| 字符 | 名称   | 功能说明             | 示例                   |
| ---- | ------ | -------------------- | ---------------------- |
| `:`  | 冒号   | 空命令（NOP操作）    | `: > file # 清空文件`  |
| `~`  | 波浪号 | 用户主目录           | `cd ~`                 |
| `-`  | 连字符 | 标准输入/输出        | `tar xvf - < file.tgz` |
| `= ` | 等号   | 变量赋值             | `name="value"`         |
| `%`  | 百分号 | 作业控制（fg %1）    | `bg %1`                |
| `^`  | 脱字符 | 替换上条命令的字符串 | `^old^new`             |

> **提示**：特殊字符的行为可能因不同的 Shell 环境（Bash、Zsh、Ksh 等）而略有差异。



