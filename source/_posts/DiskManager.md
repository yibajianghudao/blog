---
title: DiskManager
tags:
  - disk
date: 2025-05-04 14:31:05
---


# 磁盘管理

## 分类

|          | 机械硬盘(HDD)    | 固态硬盘(SSD) |
| -------- | ---------------- | ------------- |
| 性价比   | 容量大价格低     | 容量小价格高  |
| 稳定     | 抗击打能力弱     | 抗击打能力高  |
| 速度     | 读写速度(IO)稍慢 | 读写速度快    |
| 数据安全 | 数据易恢复       | 数据恢复难    |
| 寿命     | 寿命长           | 1-2w次        |

## 磁盘接口

| 接口  | 说明                                                 |
| ----- | ---------------------------------------------------- |
| SATA  | 一般家用,多用于机械硬盘,也有固态硬盘,容量大,价格较低 |
| SAS   | 给企业环境使用,一般用于机械硬盘,也有固态硬盘         |
| PCI-E | 企业级使用,固态硬盘                                  |
| U.2   | 企业级固态硬盘,接口类似SATA,兼容SATA,SAS             |

## 磁盘选型

1. 一般情况,数据备份: SATA硬盘,10krpm 4tb,8tb存放备份
2. 网站服务器使用: SAS接口 15krpm 300G,600G,900G
3. 高并发网站服务器: 选择固态硬盘PCI-E,SAS,SATA

rpm(round per minute)每分钟多少转

## 磁盘结构

1. 盘片: 实际存放数据的地方(0 1二进制数据)
2. 磁头: 贴近盘片读写数据
3. 磁道: 磁盘中的圆环形区域,从0开始
4. 扇区: 磁盘上最小存储单位,默认512字节
5. 柱面: 不同盘面上相同的磁道组成的形状

## RAID

RAID(**R**edundant **A**rray of **I**ndependent **D**isks),独立硬盘冗余阵列,简称磁盘阵列,利用虚拟化存储技术把多个硬盘组合起来成为一个或多个硬盘阵列组,目的是为提升效能或资料冗余,或是两者同时提升.

RAID把多个硬盘组合成为一个逻辑硬盘,因此操作系统只会把它当作一个实体硬盘,RAID常用在服务器电脑上,并且常使用完全相同的硬盘作为组合.

服务器需要先制作完raid之后才能安装系统,部署服务.

### 特点

根据不同的raid级别有所区别,一般无法同时满足:

1. 获取更多容量
2. 获取更高性能
3. 获取更高冗余(安全)

### RAID级别

| Raid级别        | 最少需要硬盘数 | 安全冗余                | 可用容量               | 性能                      | 使用场景                       | 举例                          |
| --------------- | -------------- | ----------------------- | ---------------------- | ------------------------- | ------------------------------ | ----------------------------- |
| Raid0(条带串联) | 1              | 最低,一块损坏则全部损坏 | 所有硬盘容量的和       | 读写最快(n倍)             | 追求最大容量,速度,不在乎安全性 | 数据库从库,存储从库,web服务器 |
| Raid1(镜像)     | 只能有两块     | 100%                    | 两块硬盘容量之和的一半 | 读取速度正常,写入速度慢   | 只追求安全性,不追求速度        | 系统盘,监控服务器             |
| Raid5           | 3              | 最多损坏一块            | 损失一块盘             | 读取速度正常,写入性能不好 | 追求最大容量,最小预算          | 普遍数据库,存储,访问量不高    |
| Raid10          | 4              | 最多损坏一半            | 损失所有硬盘容量的一半 | 读写比较快                | 对于安全和性能都需要           | 高并发或高访问量的数据库主库  |

#### RAID0

最少需要1台磁盘才能运作.

RAID0,又称"带区卷",将多个磁盘**并联**起来成为一个大容量的磁盘,文件将会被分成不同的部分同时IO,因此速度比单个磁盘要快,但无冗余功能,没有容错能力,一个磁盘(物理)损坏,则所有数据丢失.

![RAID 0](DiskManager/250px-RAID_0.svg.png)

#### RAID1

只能2台磁盘运作.

两个磁盘相互镜像,写速度较慢(需要写在两个磁盘),在一些多线程操作系统中能有很好的读取速度(并行读取).可靠性最高,只要有一个磁盘正常即可

![RAID 1](DiskManager/250px-RAID_1.svg.png)

#### RAID5

最少需要3台磁盘才能运作.

>  奇偶校验位:
>
> 一些RAID使用奇偶校验块实现冗余。如果阵列中的一块磁盘出现故障，工作磁盘中的数据块与奇偶校验块一起来重建丢失的数据。
>
> 下面的图表每列表示一个磁盘，假设A1 = 00000111、A2 = 00000101以及A3 = 00000000。
>
> A1、A2、A3 异或(不同取0,相同取1)得到的Ap等于00000010。
>
> 如果第二个磁盘出现故障，A2将不能被访问，但是可以通过A1、A3与Ap的异或进行重建:
>
> A1 XOR A3 XOR Ap = 00000101
>
> 同理其他磁盘故障也可以通过其他两个磁盘数据与奇偶校验位重建.
>
> ```
>        冗余磁盘阵列
>  A1        A2        A3        Ap
>  B1        B2        Bp        B3
>  c1        Cp        C2        c3
>  Dp        D1        D2        D3
> ```

RAID 5使用奇偶校验位,将奇偶校验位存储在不同磁盘上,当RAID 5的一个磁盘数据发生损坏后,可以利用剩下的数据和相应的奇偶校验信息去恢复被损坏的数据.RAID 5可以理解为是RAID 0和RAID 1的折衷方案.RAID 5可以为系统提供数据安全保障,最多允许一块硬盘故障,保障程度比镜像(RAID2)低,磁盘空间利用率要比镜像高.RAID5具有和RAID0相似的读取速度,但由于多了一个奇偶校验信息,写入速度会比单独写入一块硬盘较慢(RAID5并不是像RAID0那样的并行存储).

#### RAID10

最少需要4台磁盘才能运作.

RAID10:

RAID 10是先做镜像卷RAID 1 将所有硬盘分为两组，再做RAID 0 执行条带化操作分割数据 ，视为以RAID 1作为最低组合，然后将每组RAID 1视为一个“硬盘”组合为RAID 0运作。当RAID 10有一块磁盘故障后,其余磁盘会继续运作.

![RAID 1+0](DiskManager/250px-RAID_10.svg.png)

RAID 01:

RAID 01则是跟RAID 10的程序相反，是先将数据分割。再做镜像卷RAID 1 它将所有的硬盘分为两组，每组各自构成为RAID 0作为最低组合，而将两组硬盘组合为RAID 1运作。当RAID 01有一块磁盘故障后,同组RAID0磁盘会停止运作.可靠性较低.

![RAID 0+1](DiskManager/250px-RAID_01.svg.png)

# 系统管理

磁盘的使用分为三步:分区,创建文件系统,挂载

## 磁盘分区

磁盘分区是将一块物理硬盘划分为多个逻辑分区,目的是单独管理各个部分,允许多个文件系统位于同一个磁盘上,优点:

1. 从逻辑上隔离数据.
2. 如果一个分区出现逻辑损坏,损坏的仅仅是分区而不是整个硬盘
3. 避免过大的日志或其他文件占满导致整个计算机故障
4. 一些场景需要使用多个分区,如多重启动,swap分区

